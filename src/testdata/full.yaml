api:
  name: example_app_engine
  version: 0.1.0
  description: "Example interactive application engine API"
  impl_lang: cpp
  targets:
    - android
    - ios
    - web

flatbuffers:
  - specs/common.fbs

handles:
  - name: Engine
    description: "Top-level application engine instance"
  - name: Renderer
    description: "Rendering context bound to a platform surface"
  - name: Scene
    description: "Scene graph container"
  - name: Texture
    description: "GPU texture resource"

interfaces:
  - name: lifecycle
    description: "Engine creation, configuration, and teardown"
    constructors:
      - name: create_engine
        description: "Create and initialize the engine instance"
        returns:
          type: handle:Engine
        error: Common.ErrorCode

  - name: renderer
    description: "Rendering context and frame management"
    methods:
      - name: create_renderer
        parameters:
          - name: engine
            type: handle:Engine
          - name: config
            type: Rendering.RendererConfig
            transfer: ref
        returns:
          type: handle:Renderer
        error: Common.ErrorCode
      - name: destroy_renderer
        parameters:
          - name: renderer
            type: handle:Renderer
      - name: begin_frame
        parameters:
          - name: renderer
            type: handle:Renderer
        error: Common.ErrorCode
      - name: end_frame
        parameters:
          - name: renderer
            type: handle:Renderer
        error: Common.ErrorCode

  - name: texture
    description: "Texture resource loading and management"
    methods:
      - name: load_texture_from_path
        parameters:
          - name: renderer
            type: handle:Renderer
          - name: path
            type: string
        returns:
          type: handle:Texture
        error: Common.ErrorCode
      - name: load_texture_from_buffer
        parameters:
          - name: renderer
            type: handle:Renderer
          - name: data
            type: buffer<uint8>
            transfer: ref
          - name: format
            type: Rendering.TextureFormat
        returns:
          type: handle:Texture
        error: Common.ErrorCode
      - name: destroy_texture
        parameters:
          - name: texture
            type: handle:Texture

  - name: input
    description: "Input event processing"
    methods:
      - name: push_touch_events
        description: "Hot path - minimal marshalling overhead"
        parameters:
          - name: engine
            type: handle:Engine
          - name: events
            type: Input.TouchEventBatch
            transfer: ref
        error: Common.ErrorCode

  - name: events
    description: "Poll for events from the implementation"
    methods:
      - name: poll_events
        description: "Drain pending events. Call once per frame."
        parameters:
          - name: engine
            type: handle:Engine
          - name: events
            type: Common.EventQueue
            transfer: ref_mut
        error: Common.ErrorCode
